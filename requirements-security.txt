# requirements-security.txt
# 安全相关的Python依赖包

# ==============================================================================
# 核心Web框架和服务器（带安全功能）
# ==============================================================================
fastapi>=0.104.0
uvicorn[standard]>=0.24.0
gunicorn>=21.2.0

# ==============================================================================
# 认证和授权
# ==============================================================================
python-jose[cryptography]>=3.3.0  # JWT处理
passlib[bcrypt]>=1.7.4           # 密码哈希
python-multipart>=0.0.6          # 表单处理
bcrypt>=4.0.1                    # 密码加密

# ==============================================================================
# 数据验证和清理
# ==============================================================================
pydantic>=2.0.0                  # 数据验证
email-validator>=2.0.0           # 邮箱验证
python-dotenv>=1.0.0            # 环境变量管理
bleach>=6.0.0                   # HTML清理

# ==============================================================================
# 加密和安全
# ==============================================================================
cryptography>=41.0.0             # 加密库
secrets                          # 安全随机数（内置）
hashlib                          # 哈希函数（内置）

# ==============================================================================
# SQL安全
# ==============================================================================
sqlalchemy>=2.0.0               # ORM框架
asyncpg>=0.28.0                 # PostgreSQL异步驱动
psycopg2-binary>=2.9.0         # PostgreSQL驱动

# ==============================================================================
# 速率限制和缓存
# ==============================================================================
redis>=5.0.0                    # Redis客户端
aioredis>=2.0.1                # 异步Redis
slowapi>=0.1.8                 # FastAPI速率限制

# ==============================================================================
# 安全扫描和测试工具
# ==============================================================================
bandit>=1.7.5                   # Python安全扫描
safety>=2.3.5                   # 依赖漏洞检查
pylint>=3.0.0                   # 代码质量检查
mypy>=1.7.0                     # 类型检查
black>=23.0.0                   # 代码格式化
isort>=5.12.0                   # 导入排序

# ==============================================================================
# 日志和监控
# ==============================================================================
python-json-logger>=2.0.7      # JSON日志格式
sentry-sdk>=1.38.0             # 错误追踪
prometheus-client>=0.19.0      # 监控指标

# ==============================================================================
# HTTP安全
# ==============================================================================
httpx>=0.25.0                  # 安全的HTTP客户端
aiohttp>=3.9.0                 # 异步HTTP
certifi>=2023.11.17           # SSL证书
urllib3>=2.0.7                 # HTTP库

# ==============================================================================
# Telegram Bot安全
# ==============================================================================
python-telegram-bot>=20.6      # Telegram Bot API
aiogram>=3.2.0                 # 异步Telegram Bot

# ==============================================================================
# 文件处理安全
# ==============================================================================
python-magic>=0.4.27           # 文件类型检测
pillow>=10.1.0                 # 图像处理（带安全修复）

# ==============================================================================
# CORS和安全头
# ==============================================================================
fastapi-cors>=0.0.6           # CORS支持
secure>=0.3.0                 # 安全头设置

# ==============================================================================
# 测试依赖
# ==============================================================================
pytest>=7.4.0                  # 测试框架
pytest-asyncio>=0.21.0        # 异步测试
pytest-cov>=4.1.0             # 覆盖率测试
httpx-mock>=0.2.0             # HTTP模拟
faker>=20.0.0                 # 假数据生成

# ==============================================================================
# 开发工具
# ==============================================================================
pre-commit>=3.5.0             # Git钩子
commitizen>=3.12.0            # 提交规范
python-semantic-release>=8.5.0 # 语义化版本

# ==============================================================================
# 特定安全功能
# ==============================================================================
pyotp>=2.9.0                  # 双因素认证
qrcode>=7.4.2                 # QR码生成（用于2FA）
argon2-cffi>=23.1.0          # Argon2密码哈希
itsdangerous>=2.1.2          # 签名和令牌

# ==============================================================================
# 输入验证
# ==============================================================================
validators>=0.22.0            # 各种验证器
phonenumbers>=8.13.0         # 电话号码验证
pycountry>=23.12.0           # 国家代码验证

# ==============================================================================
# 防止常见攻击
# ==============================================================================
python-decouple>=3.8          # 配置管理
ratelimit>=2.2.1            # 函数级速率限制
captcha>=0.5.0              # 验证码生成

# ==============================================================================
# 审计和合规
# ==============================================================================
audit-log>=0.2.0            # 审计日志
python-gdpr>=0.2.0          # GDPR合规工具